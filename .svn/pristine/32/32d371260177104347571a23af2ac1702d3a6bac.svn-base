PreLevel = {
    oTab :null,
    fnNoop: function () { },
    fnAction: function (opt) {
        var act = { view: "fnViewInfo", update: "fnUpdateInfo", dele: "fnDeleteInfo" };
        if (opt && act[opt])
            return act[opt];
        return "fnNoop";
    },
    fnDeleteInfo: function () {
        //var tr = elm.parentNode.parentNode;
        //parent.Common.WindowBox(tr.firstElementChild, '80%', '80%', "/PreLevel/ShowPreLevel?Oper=Show&id=" + elm.name);
    },
    //获取压力等级列表
    GetLevelList: function () {
        $.ajax({
            type: "POST",
            data: { LevelName: $("#LevelName").val() },
            url: "/PreLevel/GetLevelList",
            dataType: "json",
            error: function (xhr) {
                console.dir(xhr);
                parent.Common.MsgBox("请求失败,请稍后再试");
            },
            success: function (data) {
                var Str = "";
                for (var i = 0; i < data.length; i++) {
                    Str += "<tr><td class='com_w15pen'>" + data[i].PressureName + "</td>";
                    Str += "<td title='" + data[i].PressureDesc + "'>" + data[i].PressureDesc + "</td>";
                    Str += "<td class='com_w15pen com_TextCenter'>" + (data[i].Status == 1 ? "启用" : "停用") + "</td>";
                    Str += "<td class='com_w20pen com_TextCenter'>";
                    Str += "<a href='javascript:void(0)' title='view' name='" + data[i].Id + "'>查看|</a> ";
                    Str += "<a href='javascript:void(0)' title='update' name='" + data[i].Id + "'>修改|</a> ";
                    Str += "<a href='javascript:void(0)' title='dele' name='" + data[i].Id + "'>删除</a> ";
                    Str += "</td></tr>";
                }
                $("#ComList tbody").html(Str);
                PreLevel.oTab.fnResizeTable();
            }
        });
    },
    fnLoad: function () {
        $("#tbDiv").css("height", $(window).height() * 0.9);
        $("#ComList").delegate("a", "click", function (evt) {
            var target = evt.target || evt;
            if (!target.title) return;
            PreLevel[PreLevel.fnAction(target.title)](target);
        });
        PreLevel.oTab = new comTab();
        PreLevel.oTab.fnInit();
    },
    fnShowViewAdd: function () {
        parent.Common.WindowBox("Add-Dev", '80%', '80%', "/PreLevel/ShowPreLevel?Oper=Add&id=0");
    },
    fnUpdateInfo: function (elm) {
        var tr = elm.parentNode.parentNode;
        parent.Common.WindowBox(tr.firstElementChild.textContent, '80%', '80%', "/PreLevel/ShowPreLevel?Oper=Edit&id=" + elm.name);
    },
    fnViewInfo: function (elm) {
        var tr = elm.parentNode.parentNode;
        parent.Common.WindowBox(tr.firstElementChild.textContent, '80%', '80%', "/PreLevel/ShowPreLevel?Oper=Show&id=" + elm.name);
    }
    
};
window.onload = PreLevel.fnLoad;